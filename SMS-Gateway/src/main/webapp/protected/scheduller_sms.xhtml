<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">
    <h:head>
        <title>Facelet Title</title>
        <link rel="stylesheet" href="${request.contextPath}/resources/css/sms_login_form.css" type="text/css" media="screen" />
    </h:head>
    <h:body>
        <p:growl globalOnly="true" id="growlSchedullerId" showSummary="true" showDetail="true"/>
        <h:form>
            <div id="header_login">
                <div id="header_login_left">
                    <p:outputLabel value="SMS" style="color: #33cc00;font-weight: bold;font-size: 14px"/> 
                    <p:outputLabel value="Gateway" style="color: #ffffff;margin-left: 4px"/>
                </div>
                <div style="float: right;padding-top: 7px;margin-right: 5px">
                    <p:commandButton value="Logout" style="font-family:Trebuchet MS;font-size: 13px" icon="ui-icon-power"/>
                </div>
            </div>
            <div id="header_menu" style="margin-bottom: 10px" >
                <h:panelGrid style="font-size: 12px;padding-top: 6px" columns="4" id="menuId">
                    <p:commandButton value="Kirim SMS"  title="Kirim SMS" action="#{homeController.doRedirectSms()}"/>
                    <p:commandButton value="Scheduller SMS"  title="Scheduller SMS" action="#{homeController.doRedirectSchedullerSms()}"/>
                    <p:commandButton value="SMS History"  title="SMS History"/>
                    <p:commandButton value="Modem Config" title="Modem Config" action="#{homeController.doRedirectModemConfig()}"/>
                </h:panelGrid>
            </div>
        </h:form>
        <p:outputLabel value="Scheduller SMS" style="font-size: 16px;margin-left: 10px;font-weight: bold;color: #006600" />
        <h:form id="smsFormId">
            <div style="font-size: 12px;margin-left: 5px;margin-top: 10px;margin-left: 20px;margin-bottom: 30px">   
                <h:panelGrid columns="2"  cellpadding="1" cellspacing="4" id="modemFormInputId">
                    <p:outputLabel value="Nama Schedule" for="nameId"/>
                    <p:outputLabel value="Jenis Schedule" for="scheduleType"/>
                    <p:inputText  id="nameId" style="width: 247px"  required="true" value="#{schedullerSendingSMSController.schedullerSmsModel.name}"/>
                    <p:selectOneMenu id="scheduleType"  value="#{schedullerSendingSMSController.schedullerSmsModel.scheduleType}"
                                     required="true" label="Pilihan Modem"
                                     style="text-align: left;width:180px" >
                        <f:selectItem itemLabel="Silahkan Pilih" itemValue="" />
                        <f:selectItem itemLabel="Diulang" itemValue="REPEAT"/>
                        <f:selectItem itemLabel="Sekali Kirim" itemValue="ONETIME"/>
                        <p:ajax listener="#{schedullerSendingSMSController.changeScheduleType()}" update="pengulanganId"  partialSubmit="true" process="@this"/>
                    </p:selectOneMenu>
                    <p:outputLabel value="Kondisi Pengulangan" for="pengulanganId"/>

                    <p:outputLabel value="Tanggal Kirim" for="sendDate"/>
                    <p:selectOneMenu id="pengulanganId"  value="#{schedullerSendingSMSController.schedullerSmsModel.isRepeatOnCondition}" disabled="#{schedullerSendingSMSController.isDisable}"
                                     required="true" label="Pilihan Modem"
                                     style="text-align: left;width: 250px" >
                        <f:selectItem itemLabel="Silahkan Pilih" itemValue="" />
                        <f:selectItem itemLabel="Setiap Hari" itemValue="EVERYDAY"/>
                        <f:selectItem itemLabel="Setiap Minggu" itemValue="EVERYWEEK"/>
                        <f:selectItem itemLabel="Setiap Bulan" itemValue="EVERYMONTH" />
                        <f:selectItem itemLabel="Setiap Tahun" itemValue="EVERYYEAR" />
                        <f:selectItem itemLabel="Waktu Tertentu" itemValue="ONETIME" />

                    </p:selectOneMenu>
                    <p:calendar id="sendDate"  pattern="dd MMMM yyyy" value="#{schedullerSendingSMSController.schedullerSmsModel.sendDate}"/>

                    <p:outputLabel value=" Pengulangan " for="timeSend" />
                    <p:outputLabel value="Waktu Kirim " for="timeSend" />
                    <p:spinner min="1" max="1000" stepFactor="1" size="5"  value="#{schedullerSendingSMSController.schedullerSmsModel.repeatTime}" readonly="true"/>
                    <pe:timePicker intervalMinutes="10" id="timeSend" required="true" value="#{schedullerSendingSMSController.schedullerSmsModel.sendTime}"/>



                    <p:outputLabel value="Jenis Modem" for="modemId"/>
                    <p:outputLabel value="Kirim Ke" for="sendId"/>
                    <p:selectOneMenu id="modemId"  value="#{schedullerSendingSMSController.schedullerSmsModel.modemId}"
                                     required="true" label="Pilihan Modem"
                                     style="text-align: left;width: 250px" >
                        <f:selectItem itemLabel="Silahkan Pilih" itemValue="" />
                        <f:selectItems value="#{sendingSMSController.mapOfModem}"/>
                    </p:selectOneMenu>
                    <h:panelGroup>
                        <p:inputText value="#{schedullerSendingSMSController.schedullerSmsModel.listPhoneAsString}"  placeholder="NO HP" id="sendId" required="true" style="width: 250px" readonly="true"/>
                        <p:commandButton value="+"  style="margin-left: 5px"  oncomplete="PF('addDialogSMS').show()" immediate="true"/>
                    </h:panelGroup>
                </h:panelGrid> 
                <h:panelGrid columns="1">
                    <p:outputLabel value="Isi SMS" for="isiSms"/>
                    <p:inputTextarea id="isiSms" rows="4" cols="20" counter="counter" maxlength="150" value="#{schedullerSendingSMSController.schedullerSmsModel.smsContent}" required="true"
                                     style="width: 545px; height: 90px;" counterTemplate="{0} sisa karakter" autoResize="true" label="SMS" title="SMS"/>

                    <p:outputLabel/>
                    <p:outputLabel id="counter"/>
                </h:panelGrid>
                <h:panelGrid columns="2">
                    <p:commandButton value="Simpan" icon="ui-icon-disk" action="#{schedullerSendingSMSController.saveSchedule()}" update="smsFormId,:growlSchedullerId,:tableViewId" />
                    <p:commandButton value="Batal" title="Batal" process="@this" update="smsFormId" action="#{schedullerSendingSMSController.doReset()}" immediate="true"
                                     icon="ui-icon-refresh" styleClass="isitext_hrm"  style="margin-right: 5px" >  
                        <p:resetInput target="smsFormId" />  
                    </p:commandButton>

                </h:panelGrid>
            </div>

        </h:form>
        <p:dialog widgetVar="addDialogSMS" header="Tambah No.HP" modal="true" width="375" dynamic="true" 
                  appendTo="@(body)" resizable="false"   closeOnEscape="true" >
            <h:form id="addId">
                <p:messages/>
                <h:panelGrid  columns="4">
                    <p:outputLabel value="No. HP"/>
                    <p:outputLabel value=":"  />
                    <p:inputText  value="#{schedullerSendingSMSController.schedullerSmsModel.destination}" placeholder="Contoh : +8787878787"/>
                    <p:commandButton value="Tambah" action="#{schedullerSendingSMSController.doAdd()}" id="yesId" title="Ya" update=":smsFormId:sendId,addId"
                                     style="margin-right: 5px" />
                </h:panelGrid>
                <p:focus for="addId" />
            </h:form>
        </p:dialog>
        <h:form id="tableViewId">

            <p:separator />
            <div style="margin: 20px">
                <h:panelGrid columns="4">
                    <p:outputLabel value="Pencarian" style="font-weight: bold" />
                    <p:outputLabel value=":" style="font-weight: bold"  />
                    <p:inputText  value="#{schedullerSendingSMSController.pencarian}"/>
                    <p:commandButton value="Cari"  action="#{schedullerSendingSMSController.doSearch()}" update="tableScheduleId"/>
                </h:panelGrid>
                <p:dataTable value="#{schedullerSendingSMSController.lazyDataModel}" var="tastDefinitions" lazy="true" paginator="true" pageLinks="5" paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {PageLinks} {NextPageLink} {LastPageLink}"
                             rows="5" rowsPerPageTemplate="5,7,11,15,21,25,31" style="margin-top: 10px;margin-bottom: 10px" id="tableScheduleId" 
                             rowIndexVar="no">
                    <f:facet name="header">  
                        <h:outputText value="Daftar Definisi Tugas"/>
                    </f:facet> 
                    <p:column style="text-align: center;width: 3%">
                        <f:facet name="header">  
                            <h:outputText  value="No." />
                        </f:facet>
                        <h:outputLabel value="#{no+1}." />
                    </p:column>
                    <p:column sortBy="#{tastDefinitions.name}"  >
                        <f:facet name="header">
                            <h:outputText value="Nama"/>
                        </f:facet>
                        <h:outputLabel value= "#{tastDefinitions.name}" />
                    </p:column>
                    <p:column sortBy="#{tastDefinitions.scheduleType}" >
                        <f:facet name="header">
                            <h:outputText value="Jenis Task"/>
                        </f:facet>
                        <h:outputLabel value= "#{tastDefinitions.scheduleType}" />
                    </p:column>
                    <p:column sortBy="isRepeatOnCondition" >
                        <f:facet name="header">
                            <h:outputText value="Jenis Pengulangan"/>
                        </f:facet>
                        <h:outputLabel value= "#{tastDefinitions.isRepeatOnCondition}" />
                    </p:column>
                    <p:column sortBy="name" >
                        <f:facet name="header">
                            <h:outputText value="Tanggal Pengiriman"/>
                        </f:facet>
                        <p:outputLabel value= "#{tastDefinitions.date}" >
                            <f:convertDateTime pattern="dd MMMM yyyy" />
                        </p:outputLabel>
                    </p:column>
                    <p:column sortBy="name" >
                        <f:facet name="header">
                            <h:outputText value="Waktu Pengiriman"/>
                        </f:facet>
                        <p:outputLabel value= "#{tastDefinitions.time}" >
                            <f:convertDateTime pattern="hh:mm" />
                        </p:outputLabel>
                    </p:column>
                    <p:column sortBy="name" >
                        <f:facet name="header">
                            <h:outputText value="No Tujuan"/>
                        </f:facet>
                        <p:outputLabel value= "#{tastDefinitions.destination}" />
                    </p:column>
                    <p:column sortBy="modemDefinition" >
                        <f:facet name="header">
                            <h:outputText value="Nama Modem"/>
                        </f:facet>
                        <p:outputLabel value= "#{tastDefinitions.modemDefinition.manufacture}" />
                    </p:column>
                    <p:column sortBy="modemDefinition" >
                        <f:facet name="header">
                            <h:outputText value="Port"/>
                        </f:facet>
                        <p:outputLabel value= "#{tastDefinitions.modemDefinition.comId}" />
                    </p:column>
                    <f:facet name="footer">
                        <p:outputLabel value="Total : "/>
                        <p:outputLabel value="#{schedullerSendingSMSController.lazyDataModel.rowCount}"/>
                        <p:outputLabel value="Data" style="margin-left: 3px"/>
                    </f:facet>  
                </p:dataTable>
            </div>

        </h:form>
    </h:body>
</html>

